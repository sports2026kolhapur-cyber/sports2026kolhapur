<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<title>Admin Panel ‚Äì ‡§®‡§ø‡§ï‡§æ‡§≤ ‡§≠‡§∞‡§£‡•á</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#1e40af;
  --bg:#f1f5f9;
  --card:#ffffff;
}
body{
  margin:0;
  padding:16px;
  background:var(--bg);
  font-family:"Noto Sans Devanagari","Mukta",system-ui,sans-serif;
}
.container{
  max-width:600px;
  margin:auto;
}
.card{
  background:var(--card);
  padding:24px;
  border-radius:14px;
  box-shadow:0 8px 20px rgba(0,0,0,0.12);
}
h1{
  margin-top:0;
  text-align:center;
  color:var(--primary);
}
label{
  font-weight:700;
  margin-top:16px;
  display:block;
}
select,input{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:10px;
  border:1.8px solid #cbd5e1;
  font-size:15px;
}
button{
  width:100%;
  margin-top:24px;
  padding:14px;
  border:none;
  border-radius:12px;
  background:var(--primary);
  color:#fff;
  font-size:16px;
  font-weight:800;
  cursor:pointer;
}
.success{
  margin-top:16px;
  color:#065f46;
  font-weight:800;
  display:none;
  text-align:center;
}
.logout{
  background:#7c2d12;
}
</style>
</head>

<body>

<div class="container">
  <div class="card">
    <h1>üèÜ ‡§®‡§ø‡§ï‡§æ‡§≤ ‡§≠‡§∞‡§£‡•á (Admin)</h1>

    <!-- ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ -->
    <label>‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</label>
    <select id="main">
      <option value="">‚Äî ‡§®‡§ø‡§µ‡§°‡§æ ‚Äî</option>
      <option value="‡§ï‡•ç‡§∞‡•Ä‡§°‡§æ">‡§ï‡•ç‡§∞‡•Ä‡§°‡§æ</option>
      <option value="‡§∏‡§æ‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø‡§ï">‡§∏‡§æ‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø‡§ï</option>
    </select>

    <!-- ‡§∏‡§π‡§≠‡§æ‡§ó ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ -->
    <label>‡§∏‡§π‡§≠‡§æ‡§ó ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</label>
    <select id="type">
      <option value="">‚Äî ‡§®‡§ø‡§µ‡§°‡§æ ‚Äî</option>
      <option value="‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï">‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï</option>
      <option value="‡§¶‡•Å‡§π‡•á‡§∞‡•Ä">‡§¶‡•Å‡§π‡•á‡§∞‡•Ä</option>
      <option value="‡§∏‡§æ‡§Ç‡§ò‡§ø‡§ï">‡§∏‡§æ‡§Ç‡§ò‡§ø‡§ï</option>
    </select>

    <!-- ‡§ñ‡•á‡§≥ / ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ -->
    <label>‡§ñ‡•á‡§≥ / ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ</label>
    <select id="program">
      <option value="">‚Äî ‡§®‡§ø‡§µ‡§°‡§æ ‚Äî</option>
    </select>

    <!-- ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï -->
    <label>‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï</label>
    <input id="position" placeholder="‡§â‡§¶‡§æ. ‡§™‡•ç‡§∞‡§•‡§Æ / ‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø">

    <!-- ‡§µ‡§ø‡§ú‡•á‡§§‡§æ -->
    <label>‡§µ‡§ø‡§ú‡•á‡§§‡§æ ‡§®‡§æ‡§µ ( / ‡§µ‡§æ‡§™‡§∞‡•Ç ‡§∂‡§ï‡§§‡§æ )</label>
    <input id="name" placeholder="‡§®‡§æ‡§µ1 / ‡§®‡§æ‡§µ2 / ‡§®‡§æ‡§µ3">

    <!-- ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø -->
    <label>‡§Æ‡§Ç‡§°‡§≥ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø</label>
    <input id="office" placeholder="‡§Ø‡§æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§ï‡•Ä ‡§Æ‡§Ç‡§°‡§≥, ‡§ï‡•ã‡§≤‡•ç‡§π‡§æ‡§™‡•Ç‡§∞">

    <button onclick="save()">‡§®‡§ø‡§ï‡§æ‡§≤ Save ‡§ï‡§∞‡§æ</button>

    <div id="success" class="success">‚úÖ ‡§®‡§ø‡§ï‡§æ‡§≤ ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä‡§∞‡•Ä‡§§‡•ç‡§Ø‡§æ ‡§∏‡•á‡§µ‡•ç‡§π ‡§ù‡§æ‡§≤‡§æ</div>

    <button class="logout" onclick="logout()">Logout</button>
  </div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycby4jBFfFt6GSBlQj_Cs22HrFA-0oXMZNQd0tBHA7h_FHYR2FLqR4UFaiCAfruYJQd9-NA/exec";

/* üîê LOGIN GUARD */
if(sessionStorage.getItem("adminLogged") !== "1"){
  location.href = "admin-login.html";
}

/* üîÅ LOAD PROGRAMS FROM ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä SHEET */
document.getElementById("main").addEventListener("change", loadPrograms);
document.getElementById("type").addEventListener("change", loadPrograms);

async function loadPrograms(){
  const main = document.getElementById("main").value;
  const type = document.getElementById("type").value;
  const program = document.getElementById("program");

  program.innerHTML = `<option value="">‚Äî ‡§®‡§ø‡§µ‡§°‡§æ ‚Äî</option>`;

  if(!main || !type) return;

  const res = await fetch(
    `${API}?action=adminPrograms&main=${encodeURIComponent(main)}&type=${encodeURIComponent(type)}`
  );
  const list = await res.json();

  list.forEach(p=>{
    const opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    program.appendChild(opt);
  });
}

/* üíæ SAVE RESULT */
async function save(){
  document.getElementById("success").style.display = "none";

  const main     = document.getElementById("main");
  const type     = document.getElementById("type");
  const program  = document.getElementById("program");
  const position = document.getElementById("position");
  const name     = document.getElementById("name");
  const office   = document.getElementById("office");

  if(
    !main.value ||
    !type.value ||
    !program.value ||
    !position.value ||
    !name.value
  ){
    alert("‚ùå ‡§∏‡§∞‡•ç‡§µ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§≠‡§∞‡§æ");
    return;
  }

  const params = new URLSearchParams({
    action:"saveResult",
    main: main.value,
    type: type.value,
    program: program.value,
    position: position.value,
    name: name.value,
    office: office.value
  });

  const res = await fetch(`${API}?${params.toString()}`);
  const data = await res.json();

  if(data.ok){
    document.getElementById("success").style.display = "block";

    main.value="";
    type.value="";
    program.innerHTML = `<option value="">‚Äî ‡§®‡§ø‡§µ‡§°‡§æ ‚Äî</option>`;
    position.value="";
    name.value="";
    office.value="";
  }
}

/* üö™ LOGOUT */
function logout(){
  sessionStorage.removeItem("adminLogged");
  location.href="dashboard.html";
}
</script>

</body>
</html>
