<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<title>Admin ‚Äì ‡§µ‡•á‡§≥‡§æ‡§™‡§§‡•ç‡§∞‡§ï ‡§≠‡§∞‡§æ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:"Mukta",sans-serif;
  background:#f1f5f9;
  padding:20px;
}

.container{
  max-width:700px;
  margin:auto;
  background:#fff;
  padding:30px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,0.15);
}

h2{
  text-align:center;
  color:#1e40af;
}

select,input{
  width:100%;
  padding:12px;
  margin-top:12px;
  border-radius:10px;
  border:1.5px solid #cbd5e1;
  font-size:15px;
}

button{
  margin-top:18px;
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#16a34a;
  color:#fff;
  font-weight:700;
  font-size:16px;
  cursor:pointer;
}

.msg{
  margin-top:14px;
  font-weight:700;
  text-align:center;
}
</style>
</head>

<body>

<div class="container">
  <h2>üóìÔ∏è Admin ‚Äì ‡§µ‡•á‡§≥‡§æ‡§™‡§§‡•ç‡§∞‡§ï ‡§®‡•ã‡§Ç‡§¶</h2>

  <select id="main">
    <option value="">‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</option>
    <option value="sports">‡§ï‡•ç‡§∞‡•Ä‡§°‡§æ</option>
    <option value="cultural">‡§∏‡§æ‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø‡§ï</option>
  </select>

  <select id="type">
    <option value="">‡§∏‡§π‡§≠‡§æ‡§ó ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</option>
    <option value="individual">‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï</option>
    <option value="duheri">‡§¶‡•Å‡§π‡•á‡§∞‡•Ä</option>
    <option value="team">‡§∏‡§æ‡§Ç‡§ò‡§ø‡§ï</option>
  </select>

  <select id="program" disabled>
  <option value="">‡§ñ‡•á‡§≥ / ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§®‡§ø‡§µ‡§°‡§æ</option>
</select>

  <input id="round" placeholder="‡§´‡•á‡§∞‡•Ä (‡§â‡§¶‡§æ. ‡§â‡§™‡§æ‡§Ç‡§§‡•ç‡§Ø ‡§´‡•á‡§∞‡•Ä)">

  <input id="teamA" placeholder="Team A">

  <input id="teamB" placeholder="Team B">

  <input type="date" id="date">

  <input type="time" id="time">

  <input id="venue" placeholder="‡§†‡§ø‡§ï‡§æ‡§£">

  <button onclick="saveVelapatrak()">‡§µ‡•á‡§≥‡§æ‡§™‡§§‡•ç‡§∞‡§ï ‡§ú‡§§‡§® ‡§ï‡§∞‡§æ</button>

  <div class="msg" id="msg"></div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycby4jBFfFt6GSBlQj_Cs22HrFA-0oXMZNQd0tBHA7h_FHYR2FLqR4UFaiCAfruYJQd9-NA/exec";


// program dropdown auto load
window.addEventListener("DOMContentLoaded", () => {
  document.getElementById("main").addEventListener("change", loadPrograms);
  document.getElementById("type").addEventListener("change", loadPrograms);
});
async function loadPrograms(){

  const main = document.getElementById("main").value;
  const type = document.getElementById("type").value;
  const prog = document.getElementById("program");

  prog.innerHTML = '<option>‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</option>';
  prog.disabled = true;

  if(!main || !type){
    prog.innerHTML = '<option value="">‡§ñ‡•á‡§≥ / ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§®‡§ø‡§µ‡§°‡§æ</option>';
    return;
  }

  const res = await fetch(
    `${API}?action=adminPrograms&main=${encodeURIComponent(main)}&type=${encodeURIComponent(type)}`
  );

  const list = await res.json();

prog.innerHTML = '<option value="">‡§ñ‡•á‡§≥ / ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§®‡§ø‡§µ‡§°‡§æ</option>';

if(list.length === 0){
  prog.innerHTML = '<option value="">‡§Ø‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞‡§æ‡§∏‡§æ‡§†‡•Ä ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§®‡§æ‡§π‡•Ä</option>';
  prog.disabled = true;
  return;
}

  list.forEach(p=>{
    const opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    prog.appendChild(opt);
  });

  prog.disabled = false;
}
async function saveVelapatrak(){

  const msg = document.getElementById("msg");
  msg.innerHTML = "Saving...";

  const main   = document.getElementById("main").value;
  const type   = document.getElementById("type").value;
  const program= document.getElementById("program").value.trim();
  const round  = document.getElementById("round").value.trim();
  const teamA  = document.getElementById("teamA").value.trim();
  const teamB  = document.getElementById("teamB").value.trim();
  const date   = document.getElementById("date").value;
  const time   = document.getElementById("time").value;
  const venue  = document.getElementById("venue").value.trim();

  if(!main || !type || !program || !round || !teamA || !teamB || !date || !time || !venue){
    msg.innerHTML = "‡§∏‡§∞‡•ç‡§µ ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§≠‡§∞‡§æ";
    return;
  }

  try{
    const res = await fetch(
     `${API}?action=addVelapatrak`+
     `&main=${encodeURIComponent(main)}`+
`&type=${encodeURIComponent(type)}`+
      `&program=${encodeURIComponent(program)}`+
      `&round=${encodeURIComponent(round)}`+
      `&teamA=${encodeURIComponent(teamA)}`+
      `&teamB=${encodeURIComponent(teamB)}`+
      `&date=${date}`+
      `&time=${time}`+
      `&venue=${encodeURIComponent(venue)}`
    );

    const data = await res.json();

    if(data.ok){
      document.getElementById("program").innerHTML =
  '<option value="">‡§ñ‡•á‡§≥ / ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§®‡§ø‡§µ‡§°‡§æ</option>';
document.getElementById("program").disabled = true;

document.getElementById("main").value = "";
document.getElementById("type").value = "";

      msg.style.color="green";
      msg.innerHTML = "‚úÖ ‡§µ‡•á‡§≥‡§æ‡§™‡§§‡•ç‡§∞‡§ï ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä‡§∞‡•Ä‡§§‡•ç‡§Ø‡§æ ‡§ú‡§§‡§® ‡§ù‡§æ‡§≤‡•á";

      document.querySelectorAll("input").forEach(i=>i.value="");
    }else{
  msg.style.color="red";
msg.innerHTML = "Error";
}

  }catch(e){
    msg.style.color="red";
    msg.innerHTML = "Server error";
  }
}
</script>

</body>
</html>
